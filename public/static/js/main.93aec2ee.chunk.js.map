{"version":3,"sources":["store/auth/actions.ts","store/auth/reducer.ts","store/transfers/actions.ts","store/transfers/reducer.ts","store/reducers.ts","store/store.ts","globals.ts","components/UserDetails.tsx","components/InputLink.tsx","components/Transfers.tsx","App.tsx","index.tsx"],"names":["login","user","type","defaultUser","displayName","limit","used","photoLink","initialState","status","addTransfer","item","updateTransfer","index","combineReducers","auth","state","action","transfers","map","e","i","store","createStore","reducer","HOST","USERDATA","token","FILEDATA","id","COPYURL","getToken","window","localStorage","getItem","getTokenExp","getIdFromUrl","url","match","createCopy","onDone","onError","a","String","console","log","fetch","resp","json","success","data","error","UserDetails","useSelector","dispatch","useDispatch","Button","color","variant","style","float","disableElevation","onClick","removeItem","ListItem","ListItemAvatar","Avatar","alt","src","ListItemText","primary","Typography","secondary","Math","floor","LinearProgress","value","useStyles","makeStyles","root","display","margin","inputWidth","maxWidth","validateUrl","length","InputLink","classes","matches","useMediaQuery","useState","validation","input","setInput","show","message","notification","notify","handleCopy","name","size","Number","capabilities","canCopy","getState","res","update","Object","assign","downloadLink","webContentLink","fileLink","alternateLink","err","toString","handleClose","event","reason","Paper","Grid","container","alignItems","spacing","padding","xs","className","TextField","helperText","onChange","target","label","fullWidth","InputProps","disableUnderline","disabled","href","Snackbar","open","autoHideDuration","onClose","Alert","severity","useRowStyles","borderBottom","Row","row","React","setOpen","TableRow","TableCell","IconButton","aria-label","component","scope","align","b","d","f","parseFloat","pow","toFixed","formatBytes","CheckCircle","green","Error","red","Sync","blue","getIcon","paddingBottom","paddingTop","colSpan","Collapse","in","timeout","unmountOnExit","Box","direction","Transfers","TableContainer","Container","Table","TableHead","TableBody","key","authButton","width","callback","preFetch","dToken","exp","cTime","Date","jsonData","total","setTimeout","App","authState","alert","height","rootElement","document","getElementById","render"],"mappings":"sOAMO,SAASA,EAAMC,GACpB,MAAO,CAAEC,KALU,QAKGD,KAAMA,GCE9B,IAAME,EAAwB,CAC5BC,YAAa,GACbC,MAAO,EACPC,KAAM,EACNC,UAAW,IAGPC,EAAe,CACnBC,QAAQ,EACRR,KAAME,G,YCbD,SAASO,EAAYC,GAC1B,MAAO,CAAET,KAJQ,MAIGS,KAAMA,GAGrB,SAASC,EAAeC,EAAeF,GAC5C,MAAO,CAAET,KAPW,SAOGS,KAAMA,EAAME,MAAOA,GCL5C,IAAML,EAA4B,GCFnBM,kBAAgB,CAC7BC,KHiBa,WAGD,IAFZC,EAEW,uDAFQR,EACnBS,EACW,uCACX,OAAQA,EAAOf,MACb,IDxBiB,QCyBf,MAAO,CAAEO,QAAQ,EAAMR,KAAOgB,EAAuBhB,MAEvD,ID1BkB,SC2BhB,MAAO,CAAEQ,QAAQ,EAAOR,KAAME,GAEhC,QACE,OAAOa,IG5BXE,UDCa,WAGZ,IAFDF,EAEA,uDAFqBR,EACrBS,EACA,uCACA,OAAQA,EAAOf,MACb,IDTe,MCUb,MAAM,GAAN,mBAAWc,GAAX,CAAmBC,EAAqBN,OAC1C,IDVkB,SCahB,OAAOK,EAAMG,KAAI,SAACC,EAAGC,GACnB,OAAIA,IAAOJ,EAAwBJ,MACzBI,EAAwBN,KAC3BS,KAUX,QACE,OAAOJ,ME3BAM,EAAQC,YAAYC,G,iHCDpBC,EAAO,sCAGPC,EAAW,SAACC,GAAD,OAAmBF,EAAO,eAAiBE,GACtDC,EAAW,SAACD,EAAeE,GAAhB,OACtBJ,EAAO,QAAUI,EAAK,UAAYF,GAEvBG,EAAU,SAACH,EAAeE,GAAhB,OACrBJ,EAAO,aAAeI,EAAK,UAAYF,GAC5BI,EAAW,kBAAMC,OAAOC,aAAaC,QAAQ,WAC7CC,EAAc,kBAAMH,OAAOC,aAAaC,QAAQ,cActD,SAASE,EAAaC,GAC3B,IAAMR,EAAKQ,EAAIC,MAAM,cACrB,OAAa,MAANT,EAAa,GAAKA,EAAG,GAGvB,SAAeU,EAAtB,wC,4CAAO,WACL1B,EACAgB,EACAW,EACAC,GAJK,qBAAAC,EAAA,oEAOGf,EAAQI,KAPX,wBASKM,EAAMP,EAAQH,EAAOgB,OAAOd,IAClCe,QAAQC,IAAIR,GAVX,SAWkBS,MAAMT,GAXxB,cAWKU,EAXL,iBAYkBA,EAAKC,OAZvB,aAYKA,EAZL,QAaQC,QAbR,wBAcCT,EAAOQ,EAAKE,KAAMrC,GAdnB,2BAiBC4B,EAAQO,EAAKG,MAAOtC,GAjBrB,0DAqBH+B,QAAQC,IAAI,sBAAZ,MACAJ,EAAQ,EAAD,GAAQ5B,GAtBZ,2D,sBCNQ,SAASuC,IACtB,IATsB9C,EAShBL,EAAOoD,aAAY,SAACrC,GAAD,OAAqBA,EAAMD,KAAKd,QACnDqD,EAAWC,cAOjB,OACE,2BACE,gBAACC,EAAA,EAAD,CACEC,MAAM,YACNC,QAAQ,YACRC,MAAO,CAAEC,MAAO,SAChBC,kBAAgB,EAChBC,QAZe,WD6BrB9B,OAAOC,aAAa8B,WAAW,UAC/B/B,OAAOC,aAAa8B,WAAW,aC5B7BT,EPpBK,CAAEpD,KARW,aOiChB,UASA,gBAAC8D,EAAA,EAAD,KACE,gBAACC,EAAA,EAAD,KACE,gBAACC,EAAA,EAAD,CAAQC,IAAI,aAAaC,IAAKnE,EAAKM,aAErC,gBAAC8D,EAAA,EAAD,CACEC,QACE,gCACE,gBAACC,EAAA,EAAD,CAAYb,QAAQ,MAAMzD,EAAKG,cAGnCoE,WAtCclE,EAsCYmE,KAAKC,MAAOzE,EAAKK,KAAOL,EAAKI,MAAS,KApCtE,2BACE,gBAACsE,EAAA,EAAD,CAAgBjB,QAAQ,cAAckB,MAAOtE,U,yDCO7CuE,EAAYC,YAAW,CAC3BC,KAAM,CACJC,QAAS,QACTC,OAAQ,UAEVC,WAAY,CACVC,SAAU,OAUd,SAASC,EAAY/C,GACnB,OAAIA,EAAIgD,OAAS,GACJjD,EAAaC,GACdgD,OAAS,EAKR,SAASC,IACtB,IAAMC,EAAUV,IACVW,EAAUC,YAAc,qBAFI,EAGRC,mBAAS,CAAErD,IAAK,GAAIsD,YAAY,IAHxB,mBAG3BC,EAH2B,KAGpBC,EAHoB,OAIHH,mBAAuB,CACpDI,MAAM,EACN7C,SAAS,EACT8C,QAAS,KAPuB,mBAI3BC,EAJ2B,KAIbC,EAJa,KAS5B3C,EAAWC,cAWX2C,EAAU,uCAAG,0CAAAxD,EAAA,0DACbkD,EAAMD,WADO,oBAET9D,EAAKO,EAAawD,EAAMvD,KAC9BO,QAAQC,IAAIhB,KACNF,EAAQI,KAJC,wBAMPM,EAAMT,EAASD,EAAOE,GAC5Be,QAAQC,IAAI,OAAQR,GAPP,SAQMS,MAAMT,GARZ,cAQPU,EARO,iBASMA,EAAKC,OATX,aASPA,EATO,QAUJC,QAVI,wBAWLC,EAAQF,EAAyBE,KACjCvC,EAAkB,CACtBkB,GAAIqB,EAAKrB,GACTsE,KAAMjD,EAAKiD,KACXC,KAAMC,OAAOnD,EAAKkD,MAClB3F,OAASyC,EAAKoD,aAAaC,QFzEhB,UACD,SEyEVpD,MAAQD,EAAKoD,aAAaC,QACtB,GACA,sCAEA1F,EAAQS,EAAMkF,WAAWtF,UAAUmE,OACzC/B,EAAS5C,EAAYC,IACrBsF,EAAO,CAAEH,MAAM,EAAM7C,SAAS,EAAM8C,QAAS,oBAvBlC,UAyBLxD,EACJ1B,EACAgB,GACA,SAAC4E,EAAKpF,GACJ,IAAMqF,EAAoBC,OAAOC,OAAO,GAAIjG,EAAM,CAChDF,OFxFM,SEyFN0C,MAAO,GACP0D,aAAcJ,EAAIK,eAClBC,SAAUN,EAAIO,gBAKhB1D,EAAS1C,EAAeS,EAAGqF,OAG7B,SAACO,EAAK5F,GACJ,IAAMqF,EAAoBC,OAAOC,OAAO,GAAIjG,EAAM,CAChDF,OFnGM,SEoGN0C,MAAO8D,EAAIC,aAIb5D,EAAS1C,EAAeS,EAAGqF,OAhDpB,gCAoDXT,EAAO,CAAEH,MAAM,EAAM7C,SAAS,EAAO8C,QAAS/C,EAAKG,QACnDP,QAAQC,IAAI,qBArDD,gCAyDfD,QAAQC,IAAI,kBAzDG,4CAAH,qDA6DVsE,EAAc,SAACC,EAA8BC,GAC7CrB,EAAaF,OACfG,EAAOU,OAAOC,OAAO,GAAIZ,EAAc,CAAEF,MAAM,KAC/ClD,QAAQC,IAAI,yBAIhB,OACE,2BACE,gBAACyE,EAAA,EAAD,CAAO5D,QAAQ,YACb,gBAAC6D,EAAA,EAAD,CAAMC,WAAS,EAACC,WAAW,SAASC,QAAS,EAAG/D,MAAO,CAAEgE,QAAS,IAChE,gBAACJ,EAAA,EAAD,CAAM5G,MAAI,EAACiH,IAAE,EAACC,UAAWrC,EAAUD,EAAQL,WAAa,IACtD,gBAAC4C,EAAA,EAAD,CACEjG,GAAG,6BACHkG,YACGnC,EAAMD,YAAcC,EAAMvD,IAAIgD,OAAS,EAAI,cAAgB,GAE9DlC,MAA4B,IAArByC,EAAMvD,IAAIgD,SAAwBO,EAAMD,WAC/Cf,MAAOgB,EAAMvD,IACb2F,SAzFQ,SAACZ,GACnBvB,EAAS,CACPxD,IAAK+E,EAAMa,OAAOrD,MAClBe,WAAYP,EAAYgC,EAAMa,OAAOrD,SAEvChC,QAAQC,IAAIuE,EAAMa,OAAOrD,OACzBhC,QAAQC,IAAIuC,EAAYgC,EAAMa,OAAOrD,SAoF3BsD,MAAM,6BACNC,WAAS,EACTC,WAAY,CAAEC,kBAAkB,MAGpC,gBAACd,EAAA,EAAD,CAAM5G,MAAI,EAACiH,GAAI,GACb,gBAACpE,EAAA,EAAD,CACE8E,SAA+B,IAArB1C,EAAMvD,IAAIgD,SAAuBO,EAAMD,WACjDjC,QAAQ,WACRD,MAAM,UACN8E,KAAK,oBACL5E,MAAO,CAAEsB,OAAQ,GACjBnB,QAASoC,GANX,WAaN,gBAACsC,EAAA,EAAD,CACEC,KAAMzC,EAAaF,KACnB4C,iBAAkB,KAClBC,QAASxB,GAET,gBAACyB,EAAA,EAAD,CACED,QAASxB,EACT0B,SAAU7C,EAAa/C,QAAU,UAAY,SAE5C+C,EAAaD,W,mMC/JlB+C,GAAehE,YAAW,CAC9BC,KAAM,CACJ,QAAS,CACPgE,aAAc,YAqCpB,IAAMC,GAA2B,SAACC,GAAS,IAnBtBtI,EAmBqB,EAChBuI,IAAMxD,UAAS,GADC,mBACjC+C,EADiC,KAC3BU,EAD2B,KAElC5D,EAAUuD,KAEhB,OACE,oCACE,kBAACM,GAAA,EAAD,CAAUvB,UAAWtC,EAAQR,MHrDZ,YGsDdkE,EAAIxI,OACH,kBAAC4I,GAAA,EAAD,KACE,kBAACC,EAAA,EAAD,CACEC,aAAW,aACXnD,KAAK,QACLtC,QAAS,kBAAMqF,GAASV,KAEvBA,EAAO,kBAAC,KAAD,MAA0B,kBAAC,KAAD,QAItC,kBAACY,GAAA,EAAD,MAEF,kBAACA,GAAA,EAAD,CAAWG,UAAU,KAAKC,MAAM,OAC7BR,EAAI9C,MAEP,kBAACkD,GAAA,EAAD,CAAWK,MAAM,SHnElB,SAAqBhH,EAAWiH,GACrC,GAAI,IAAMjH,EAAG,MAAO,UACpB,IACEkH,EAAID,GAAK,EAETE,EAAIpF,KAAKC,MAAMD,KAAK5B,IAAIH,GAAK+B,KAAK5B,IAH5B,OAIR,OAAOiH,YAAYpH,EAAI+B,KAAKsF,IAJpB,KAI2BF,IAAIG,QAAQJ,IAAM,IAF/C,CAAC,QAAS,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAEGC,GG6D7BI,CAAYhB,EAAI7C,OAC1C,kBAACiD,GAAA,EAAD,CAAWK,MAAM,SAxDzB,SAAiBjJ,GACf,OAAQA,GACN,IHlBkB,SGmBhB,OAAO,kBAACyJ,GAAA,EAAD,CAAavG,MAAO,CAAEF,MAAO0G,KAAM,QAE5C,IHnBkB,SGoBhB,OAAO,kBAACC,GAAA,EAAD,CAAOzG,MAAO,CAAEF,MAAO4G,KAAI,QAEpC,QACE,OAAO,kBAACC,GAAA,EAAD,CAAM3G,MAAO,CAAEF,MAAO8G,KAAK,SA+CNC,CAAQvB,EAAIxI,UAExC,kBAAC2I,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CAAW1F,MAAO,CAAE8G,cAAe,EAAGC,WAAY,GAAKC,QAAS,GAC9D,kBAACC,EAAA,EAAD,CAAUC,GAAIpC,EAAMqC,QAAQ,OAAOC,eAAa,GAC9C,kBAACC,EAAA,EAAD,CAAK/F,OAAQ,GH3EH,WG4EPgE,EAAIxI,OACH,kBAAC8D,EAAA,EAAD,CAAYiF,UAAU,OAAtB,cAlDK7I,EAoDOsI,EAlDxB,6BACE,kBAAC1B,EAAA,EAAD,CAAMC,WAAS,EAACyD,UAAU,MAAMvD,QAAS,GACvC,kBAACH,EAAA,EAAD,CAAM5G,MAAI,GACR,kBAAC6C,EAAA,EAAD,CAAQE,QAAQ,WAAW6E,KAAM5H,EAAKkG,aAAeoB,OAAO,UAA5D,aAIF,kBAACV,EAAA,EAAD,CAAM5G,MAAI,GACR,kBAAC6C,EAAA,EAAD,CAAQE,QAAQ,WAAW6E,KAAM5H,EAAKoG,SAAWkB,OAAO,UAAxD,kBAoDK,SAASiD,KACtB,IAAMhK,EAAYmC,aAAY,SAACrC,GAAD,OAAqBA,EAAME,aAEzD,OACE,kBAACiK,GAAA,EAAD,CAAgB3B,UAAWlC,KACzB,kBAAC/C,EAAA,EAAD,CAAYb,QAAQ,KAAKC,MAAO,CAAEsB,OAAQ,IAA1C,aAGsB,IAArB/D,EAAUmE,OACT,kBAAC+F,EAAA,EAAD,KACE,kBAAC7G,EAAA,EAAD,yBAGF,kBAAC8G,EAAA,EAAD,CAAO9B,aAAW,qBAChB,kBAAC+B,GAAA,EAAD,KACE,kBAAClC,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,MACA,kBAACA,GAAA,EAAD,aACA,kBAACA,GAAA,EAAD,CAAWK,MAAM,SAAjB,QACA,kBAACL,GAAA,EAAD,CAAWK,MAAM,SAAjB,YAGJ,kBAAC6B,EAAA,EAAD,KACGrK,EAAUC,KAAI,SAAC8H,EAAK5H,GAAN,OACb,kBAAC,GAAD,eAAKmK,IAAKnK,GAAO4H,UCpH/B,IAAMpE,GAAYC,YAAW,CAC3BC,KAAM,CACJE,OAAQ,GACR0C,QAAS,IAEX8D,WAAY,CACVzG,QAAS,QACTC,OAAQ,SACRyG,MAAO,O,SAIIC,G,qFAAf,WACEC,EACApJ,EACAC,GAHF,yBAAAC,EAAA,yDAKMmJ,EAAS9J,IACT+J,EAAM3J,KACN0J,IAAUC,EAPhB,uBAQUC,GAAS,IAAIC,MAEP,IAAO3F,OAAOyF,IAV9B,0CAY2BhJ,MAAMpB,EAASmK,IAZ1C,UAc4B,OAFd9I,EAZd,QAciBtC,OAdjB,kCAeiCsC,EAAKC,OAftC,QAegBiJ,EAfhB,OAgBgBnB,EAAwB,IAAdzE,OAAOyF,GAAcC,EACrCvJ,EACE,CACEpC,YAAa6L,EAAS7L,YACtBE,KAAM+F,OAAO4F,EAAS3L,MACtBD,MAAOgG,OAAO4F,EAASC,OACvB3L,UAAW0L,EAAS1L,WAEtBuK,GAxBZ,wBA2BUrI,EAAQ,0BA3BlB,0DA8BQA,EAAQ,EAAD,IA9Bf,gCAkCIG,QAAQC,IAAI,WACP+I,GACHO,YAAW,WACTR,IAAS,EAAOnJ,EAAQC,KACvB,KAtCT,2D,sBA0Ce,SAAS2J,KACtB,IAAMC,EAAYhJ,aAAY,SAACrC,GAAD,OAAqBA,EAAMD,QACnDwE,EAAUV,KACVvB,EAAWC,cAyCjB,OAvCyB,IAArB8I,EAAU5L,QACZkL,IACE,GACA,SAAC1L,EAAM6K,GAELxH,EAAStD,EAAMC,IACfkM,YAAW,WACTG,MAAM,wDACNhJ,EVpED,CAAEpD,KARW,aU6EX4K,MAEL,SAAC3H,GACCP,QAAQC,IAAI,UACZD,QAAQC,IAAIM,MA0BdkJ,EAAU5L,OAEV,2BACE,gBAAC6G,EAAA,EAAD,CAAOO,UAAWtC,EAAQR,MACxB,gBAAC3B,EAAD,MACA,gBAACkC,EAAD,MACA,uBAAK3B,MAAO,CAAE4I,OAAQ,SACtB,gBAACrB,GAAD,QAMJ,2BACE,gBAAC5D,EAAA,EAAD,CAAOO,UAAWtC,EAAQR,MACxB,gBAACR,EAAA,EAAD,KACE,oCAEF,gBAACA,EAAA,EAAD,wKAKA,2BACA,uBAAKsD,UAAWtC,EAAQkG,YACtB,gBAACjI,EAAA,EAAD,CACEE,QAAQ,WACR6E,KJrIS9G,2CIsITwG,OAAO,SACPnE,QApDZ,WAUE9B,OAAOC,aAAa8B,WAAW,UAC/B4H,IACE,GACA,SAAC1L,GACC2C,QAAQC,IAAI5C,GACZqD,EAAStD,EAAMC,OAEjB,SAACkD,GACCP,QAAQC,IAAI,UACZD,QAAQC,IAAIM,QA6BR,gBCjIZ,IAAMqJ,GAAcC,SAASC,eAAe,QAC5CC,iBACE,gBAAC,IAAD,CAAUrL,MAAOA,GACf,gBAAC8K,GAAD,OAEFI,M","file":"static/js/main.93aec2ee.chunk.js","sourcesContent":["import { UserData, LoginAction, LogoutAction } from \"../../type\";\r\n\r\nexport const LOGIN = \"LOGIN\";\r\nexport const LOGOUT = \"LOGOUT\";\r\nexport const EXPIRED = \"EXPIRED\";\r\n\r\nexport function login(user: UserData): LoginAction {\r\n  return { type: LOGIN, user: user };\r\n}\r\n\r\nexport function logout(): LogoutAction {\r\n  return { type: LOGOUT };\r\n}\r\n\r\nexport function expired() {\r\n  return { type: EXPIRED };\r\n}\r\n","import {\r\n  AuthState,\r\n  UserData,\r\n  LoginAction,\r\n  LogoutAction,\r\n  Action\r\n} from \"../../type\";\r\nimport { LOGIN, LOGOUT, EXPIRED } from \"./actions\";\r\n\r\nconst defaultUser: UserData = {\r\n  displayName: \"\",\r\n  limit: 0,\r\n  used: 0,\r\n  photoLink: \"\"\r\n};\r\n\r\nconst initialState = {\r\n  status: false,\r\n  user: defaultUser\r\n};\r\n\r\nexport default function reducer(\r\n  state: AuthState = initialState,\r\n  action: Action\r\n): AuthState {\r\n  switch (action.type) {\r\n    case LOGIN:\r\n      return { status: true, user: (action as LoginAction).user };\r\n\r\n    case LOGOUT:\r\n      return { status: false, user: defaultUser };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import { DriveItem, AddAction, UpdateAction } from \"../../type\";\r\n\r\nexport const ADD = \"ADD\";\r\nexport const UPDATE = \"UPDATE\";\r\n\r\nexport function addTransfer(item: DriveItem): AddAction {\r\n  return { type: ADD, item: item };\r\n}\r\n\r\nexport function updateTransfer(index: number, item: DriveItem): UpdateAction {\r\n  return { type: UPDATE, item: item, index: index };\r\n}\r\n","// import { ContactSupportOutlined } from \"@material-ui/icons\";\r\n// import { COPIED, FETCHED, FAILED } from \"../../globals\";\r\nimport { Action, UpdateAction, AddAction, DriveItem } from \"../../type\";\r\nimport { ADD, UPDATE } from \"./actions\";\r\n\r\nconst initialState: DriveItem[] = [];\r\nexport default function reducer(\r\n  state: DriveItem[] = initialState,\r\n  action: Action | AddAction | UpdateAction\r\n) {\r\n  switch (action.type) {\r\n    case ADD:\r\n      return [...state, (action as AddAction).item];\r\n    case UPDATE:\r\n      // console.log((action as UpdateAction).index);\r\n      // console.log((action as UpdateAction).item);\r\n      return state.map((e, i) => {\r\n        if (i === (action as UpdateAction).index)\r\n          return (action as UpdateAction).item;\r\n        return e;\r\n      });\r\n    // return [\r\n    //   ...state.splice(\r\n    //     (action as UpdateAction).index,\r\n    //     1,\r\n    //     (action as UpdateAction).item\r\n    //   )\r\n    // ];\r\n    // return [(action as UpdateAction).item];\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import { combineReducers } from \"redux\";\r\nimport * as auth from \"./auth\";\r\nimport * as transfers from \"./transfers\";\r\nexport default combineReducers({\r\n  auth: auth.reducer,\r\n  transfers: transfers.reducer\r\n});\r\n","import { createStore } from \"redux\";\r\nimport reducer from \"./reducers\";\r\n\r\nexport const store = createStore(reducer);\r\n","import { CompareArrowsOutlined } from \"@material-ui/icons\";\r\n\r\nexport const HOST = \"https://lace-observation.glitch.me/\";\r\nexport const DOMAIN = \"lace-observation.glitch.me\";\r\nexport const AUTHURL = HOST + \"auth/\";\r\nexport const USERDATA = (token: string) => HOST + \"user/?token=\" + token;\r\nexport const FILEDATA = (token: string, id: string) =>\r\n  HOST + \"file/\" + id + \"?token=\" + token;\r\n\r\nexport const COPYURL = (token: string, id: string) =>\r\n  HOST + \"user/file/\" + id + \"?token=\" + token;\r\nexport const getToken = () => window.localStorage.getItem(\"dtoken\");\r\nexport const getTokenExp = () => window.localStorage.getItem(\"dtokenExp\");\r\nexport const COPIED = \"copied\";\r\nexport const FETCHED = \"fetched\";\r\nexport const FAILED = \"failed\";\r\n\r\nexport function formatBytes(a: number, b?: number) {\r\n  if (0 === a) return \"0 Bytes\";\r\n  var c = 1024,\r\n    d = b || 2,\r\n    e = [\"Bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"],\r\n    f = Math.floor(Math.log(a) / Math.log(c));\r\n  return parseFloat((a / Math.pow(c, f)).toFixed(d)) + \" \" + e[f];\r\n}\r\n\r\nexport function getIdFromUrl(url: string): string {\r\n  const id = url.match(/[-\\w]{25,}/);\r\n  return id == null ? \"\" : id[0];\r\n}\r\n\r\nexport async function createCopy(\r\n  index: number,\r\n  id: number | string,\r\n  onDone: (response: any, index: number) => void,\r\n  onError: (error: any, index: number) => void\r\n) {\r\n  try {\r\n    const token = getToken();\r\n    if (token) {\r\n      const url = COPYURL(token, String(id));\r\n      console.log(url);\r\n      const resp = await fetch(url);\r\n      const json = await resp.json();\r\n      if (json.success) {\r\n        onDone(json.data, index);\r\n        return;\r\n      } else {\r\n        onError(json.error, index);\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.log(\"Error at createCopy\", error);\r\n    onError(error, index);\r\n  }\r\n}\r\n\r\nexport function clearValues() {\r\n  window.localStorage.removeItem(\"dtoken\");\r\n  window.localStorage.removeItem(\"dtokenExp\");\r\n}\r\n","import {\r\n  ListItem,\r\n  ListItemAvatar,\r\n  Avatar,\r\n  LinearProgress,\r\n  ListItemText,\r\n  Typography,\r\n  Button\r\n} from \"@material-ui/core\";\r\nimport { red } from \"@material-ui/core/colors\";\r\nimport * as React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { clearValues } from \"../globals\";\r\nimport { logout } from \"../store/auth/actions\";\r\n\r\nimport { AppState } from \"../type\";\r\n\r\nfunction UseageProgress(used: number) {\r\n  return (\r\n    <div>\r\n      <LinearProgress variant=\"determinate\" value={used} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function UserDetails() {\r\n  const user = useSelector((state: AppState) => state.auth.user);\r\n  const dispatch = useDispatch();\r\n\r\n  const handleLogout = () => {\r\n    clearValues();\r\n    dispatch(logout());\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Button\r\n        color=\"secondary\"\r\n        variant=\"contained\"\r\n        style={{ float: \"right\" }}\r\n        disableElevation\r\n        onClick={handleLogout}\r\n      >\r\n        Logout\r\n      </Button>\r\n      <ListItem>\r\n        <ListItemAvatar>\r\n          <Avatar alt=\"Remy Sharp\" src={user.photoLink} />\r\n        </ListItemAvatar>\r\n        <ListItemText\r\n          primary={\r\n            <>\r\n              <Typography variant=\"h6\">{user.displayName}</Typography>\r\n            </>\r\n          }\r\n          secondary={UseageProgress(Math.floor((user.used / user.limit) * 100))}\r\n        />\r\n      </ListItem>\r\n    </div>\r\n  );\r\n}\r\n","import {\r\n  makeStyles,\r\n  Paper,\r\n  Typography,\r\n  TextField,\r\n  Button,\r\n  Grid,\r\n  useMediaQuery\r\n} from \"@material-ui/core\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport MuiAlert, { AlertProps } from \"@material-ui/lab/Alert\";\r\nimport * as React from \"react\";\r\nimport { ChangeEvent, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  COPIED,\r\n  createCopy,\r\n  FAILED,\r\n  FETCHED,\r\n  FILEDATA,\r\n  getIdFromUrl,\r\n  getToken\r\n} from \"../globals\";\r\nimport { store } from \"../store/store\";\r\nimport { addTransfer, updateTransfer } from \"../store/transfers/actions\";\r\nimport { AppState, DriveItem, FileDataRespone } from \"../type\";\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    display: \"block\",\r\n    margin: \"0 auto\"\r\n  },\r\n  inputWidth: {\r\n    maxWidth: 300\r\n  }\r\n});\r\n\r\ntype Notification = {\r\n  show: boolean;\r\n  success: boolean;\r\n  message: string;\r\n};\r\n\r\nfunction validateUrl(url: string): boolean {\r\n  if (url.length > 0) {\r\n    const id = getIdFromUrl(url);\r\n    return id.length > 0;\r\n  }\r\n  return false;\r\n}\r\n\r\nexport default function InputLink() {\r\n  const classes = useStyles();\r\n  const matches = useMediaQuery(\"(max-width:600px)\");\r\n  const [input, setInput] = useState({ url: \"\", validation: false });\r\n  const [notification, notify] = useState<Notification>({\r\n    show: false,\r\n    success: false,\r\n    message: \"\"\r\n  });\r\n  const dispatch = useDispatch();\r\n\r\n  const updateInput = (event: ChangeEvent<HTMLInputElement>) => {\r\n    setInput({\r\n      url: event.target.value,\r\n      validation: validateUrl(event.target.value)\r\n    });\r\n    console.log(event.target.value);\r\n    console.log(validateUrl(event.target.value));\r\n  };\r\n\r\n  const handleCopy = async () => {\r\n    if (input.validation) {\r\n      const id = getIdFromUrl(input.url);\r\n      console.log(id);\r\n      const token = getToken();\r\n      if (token) {\r\n        const url = FILEDATA(token, id);\r\n        console.log(\"URL:\", url);\r\n        const resp = await fetch(url);\r\n        const json = await resp.json();\r\n        if (json.success) {\r\n          const data = (json as FileDataRespone).data;\r\n          const item: DriveItem = {\r\n            id: data.id,\r\n            name: data.name,\r\n            size: Number(data.size),\r\n            status: (data.capabilities.canCopy as boolean) ? FETCHED : FAILED,\r\n            error: (data.capabilities.canCopy as boolean)\r\n              ? \"\"\r\n              : \"Copy is not permitted on this file\"\r\n          };\r\n          const index = store.getState().transfers.length;\r\n          dispatch(addTransfer(item));\r\n          notify({ show: true, success: true, message: \"Started cloning\" });\r\n\r\n          await createCopy(\r\n            index,\r\n            id,\r\n            (res, i) => {\r\n              const update: DriveItem = Object.assign({}, item, {\r\n                status: COPIED,\r\n                error: \"\",\r\n                downloadLink: res.webContentLink,\r\n                fileLink: res.alternateLink\r\n              });\r\n              // console.log(\"COPIED: \");\r\n              // console.log(update);\r\n              // console.log(\"BEFORE: \", store.getState().transfers);\r\n              dispatch(updateTransfer(i, update));\r\n              // console.log(\"AFTER: \", store.getState().transfers);\r\n            },\r\n            (err, i) => {\r\n              const update: DriveItem = Object.assign({}, item, {\r\n                status: FAILED,\r\n                error: err.toString()\r\n              });\r\n              // console.log(\"FAILED: \");\r\n              // console.log(update);\r\n              dispatch(updateTransfer(i, update));\r\n            }\r\n          );\r\n        } else {\r\n          notify({ show: true, success: false, message: json.error });\r\n          console.log(\"failed to connect\");\r\n        }\r\n      }\r\n    } else {\r\n      console.log(\"Url has errors\");\r\n    }\r\n  };\r\n\r\n  const handleClose = (event?: React.SyntheticEvent, reason?: string) => {\r\n    if (notification.show) {\r\n      notify(Object.assign({}, notification, { show: false }));\r\n      console.log(\"Closed notification\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Paper variant=\"outlined\">\r\n        <Grid container alignItems=\"center\" spacing={0} style={{ padding: 8 }}>\r\n          <Grid item xs className={matches ? classes.inputWidth : \"\"}>\r\n            <TextField\r\n              id=\"standard-error-helper-text\"\r\n              helperText={\r\n                !input.validation && input.url.length > 0 ? \"Invalid url\" : \"\"\r\n              }\r\n              error={input.url.length === 0 ? false : !input.validation}\r\n              value={input.url}\r\n              onChange={updateInput}\r\n              label=\"Paste your drive link here\"\r\n              fullWidth\r\n              InputProps={{ disableUnderline: true }}\r\n            />\r\n          </Grid>\r\n          <Grid item xs={2}>\r\n            <Button\r\n              disabled={input.url.length === 0 ? true : !input.validation}\r\n              variant=\"outlined\"\r\n              color=\"primary\"\r\n              href=\"#outlined-buttons\"\r\n              style={{ margin: 8 }}\r\n              onClick={handleCopy}\r\n            >\r\n              Copy\r\n            </Button>\r\n          </Grid>\r\n        </Grid>\r\n      </Paper>\r\n      <Snackbar\r\n        open={notification.show}\r\n        autoHideDuration={1200}\r\n        onClose={handleClose}\r\n      >\r\n        <Alert\r\n          onClose={handleClose}\r\n          severity={notification.success ? \"success\" : \"error\"}\r\n        >\r\n          {notification.message}\r\n        </Alert>\r\n      </Snackbar>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { Button, Container, Grid, makeStyles } from \"@material-ui/core\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Collapse from \"@material-ui/core/Collapse\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Table from \"@material-ui/core/Table\";\r\nimport TableBody from \"@material-ui/core/TableBody\";\r\nimport TableCell from \"@material-ui/core/TableCell\";\r\nimport TableContainer from \"@material-ui/core/TableContainer\";\r\nimport TableHead from \"@material-ui/core/TableHead\";\r\nimport TableRow from \"@material-ui/core/TableRow\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport KeyboardArrowDownIcon from \"@material-ui/icons/KeyboardArrowDown\";\r\nimport KeyboardArrowUpIcon from \"@material-ui/icons/KeyboardArrowUp\";\r\nimport { CheckCircle, Error, Sync } from \"@material-ui/icons\";\r\nimport { AppState, CopyStatus, DriveItem } from \"../type\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { COPIED, FAILED, FETCHED, formatBytes } from \"../globals\";\r\nimport { green, red, blue } from \"@material-ui/core/colors\";\r\n\r\nconst useRowStyles = makeStyles({\r\n  root: {\r\n    \"& > *\": {\r\n      borderBottom: \"unset\"\r\n    }\r\n  }\r\n});\r\n\r\nfunction getIcon(status: CopyStatus) {\r\n  switch (status) {\r\n    case COPIED:\r\n      return <CheckCircle style={{ color: green[500] }} />;\r\n\r\n    case FAILED:\r\n      return <Error style={{ color: red[500] }} />;\r\n\r\n    default:\r\n      return <Sync style={{ color: blue[500] }} />;\r\n  }\r\n}\r\n\r\nfunction getItemInfo(item: DriveItem) {\r\n  return (\r\n    <div>\r\n      <Grid container direction=\"row\" spacing={2}>\r\n        <Grid item>\r\n          <Button variant=\"outlined\" href={item.downloadLink!} target=\"_blank\">\r\n            Download\r\n          </Button>\r\n        </Grid>\r\n        <Grid item>\r\n          <Button variant=\"outlined\" href={item.fileLink!} target=\"_blank\">\r\n            View\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst Row: React.FC<DriveItem> = (row) => {\r\n  const [open, setOpen] = React.useState(false);\r\n  const classes = useRowStyles();\r\n\r\n  return (\r\n    <>\r\n      <TableRow className={classes.root}>\r\n        {row.status !== FETCHED ? (\r\n          <TableCell>\r\n            <IconButton\r\n              aria-label=\"expand row\"\r\n              size=\"small\"\r\n              onClick={() => setOpen(!open)}\r\n            >\r\n              {open ? <KeyboardArrowUpIcon /> : <KeyboardArrowDownIcon />}\r\n            </IconButton>\r\n          </TableCell>\r\n        ) : (\r\n          <TableCell />\r\n        )}\r\n        <TableCell component=\"th\" scope=\"row\">\r\n          {row.name}\r\n        </TableCell>\r\n        <TableCell align=\"right\">{formatBytes(row.size)}</TableCell>\r\n        <TableCell align=\"right\">{getIcon(row.status)}</TableCell>\r\n      </TableRow>\r\n      <TableRow>\r\n        <TableCell style={{ paddingBottom: 0, paddingTop: 0 }} colSpan={6}>\r\n          <Collapse in={open} timeout=\"auto\" unmountOnExit>\r\n            <Box margin={1}>\r\n              {row.status === FAILED ? (\r\n                <Typography component=\"div\">row.error</Typography>\r\n              ) : (\r\n                getItemInfo(row)\r\n              )}\r\n            </Box>\r\n          </Collapse>\r\n        </TableCell>\r\n      </TableRow>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default function Transfers() {\r\n  const transfers = useSelector((state: AppState) => state.transfers);\r\n\r\n  return (\r\n    <TableContainer component={Paper}>\r\n      <Typography variant=\"h6\" style={{ margin: 8 }}>\r\n        Transfers\r\n      </Typography>\r\n      {transfers.length === 0 ? (\r\n        <Container>\r\n          <Typography>Nothing started</Typography>\r\n        </Container>\r\n      ) : (\r\n        <Table aria-label=\"collapsible table\">\r\n          <TableHead>\r\n            <TableRow>\r\n              <TableCell />\r\n              <TableCell>Name</TableCell>\r\n              <TableCell align=\"right\">Size</TableCell>\r\n              <TableCell align=\"right\">Status</TableCell>\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {transfers.map((row, i) => (\r\n              <Row key={i} {...row} />\r\n            ))}\r\n          </TableBody>\r\n        </Table>\r\n      )}\r\n    </TableContainer>\r\n  );\r\n}\r\n","import { Button, makeStyles, Paper, Typography } from \"@material-ui/core\";\nimport * as React from \"react\";\nimport { useEffect } from \"react\";\nimport \"./styles.css\";\nimport UserDetails from \"./components/UserDetails\";\nimport InputLink from \"./components/InputLink\";\nimport Transfers from \"./components/Transfers\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { AppState, UserData } from \"./type\";\nimport { AUTHURL, USERDATA, getToken, getTokenExp } from \"./globals\";\nimport { login, logout } from \"./store/auth/actions\";\n\nconst useStyles = makeStyles({\n  root: {\n    margin: 20,\n    padding: 16\n  },\n  authButton: {\n    display: \"block\",\n    margin: \"0 auto\",\n    width: 110\n  }\n});\n\nasync function callback(\n  preFetch: boolean,\n  onDone: (user: UserData, timeout: number) => void,\n  onError: (e: any) => void\n) {\n  let dToken = getToken();\n  let exp = getTokenExp();\n  if (dToken && exp) {\n    const cTime = +new Date();\n\n    if (cTime / 1000 < Number(exp)) {\n      try {\n        const resp = await fetch(USERDATA(dToken));\n\n        if (resp.status === 200) {\n          const jsonData = await resp.json();\n          const timeout = Number(exp) * 1000 - cTime;\n          onDone(\n            {\n              displayName: jsonData.displayName,\n              used: Number(jsonData.used),\n              limit: Number(jsonData.total),\n              photoLink: jsonData.photoLink\n            },\n            timeout\n          );\n        } else {\n          onError(\"Invalid authentication\");\n        }\n      } catch (error) {\n        onError(error);\n      }\n    }\n  } else {\n    console.log(\"Waiting\");\n    if (!preFetch)\n      setTimeout(() => {\n        callback(false, onDone, onError);\n      }, 300);\n  }\n}\n\nexport default function App() {\n  const authState = useSelector((state: AppState) => state.auth);\n  const classes = useStyles();\n  const dispatch = useDispatch();\n\n  if (authState.status === false)\n    callback(\n      true,\n      (user, timeout: number) => {\n        // console.log(user);\n        dispatch(login(user));\n        setTimeout(() => {\n          alert(\"Token has expired. You will have to authorise again.\");\n          dispatch(logout());\n        }, timeout);\n      },\n      (error) => {\n        console.log(\"Error:\");\n        console.log(error);\n      }\n    );\n  function handleCallback() {\n    // let user = {\n    //   displayName: \"Nadeem Siddique\",\n    //   used: 3679922594,\n    //   limit: 16106127360,\n    //   photoLink:\n    //     \"https://lh3.googleusercontent.com/a-/AOh14Gjl98oZHtObZR-pvwXMtv1Xahhm7GbKM9a9wqgU=s64\"\n    // };\n    // dispatch(login(user));\n    // console.log(\"dispatched\");\n    window.localStorage.removeItem(\"dtoken\");\n    callback(\n      false,\n      (user) => {\n        console.log(user);\n        dispatch(login(user));\n      },\n      (error) => {\n        console.log(\"Error:\");\n        console.log(error);\n      }\n    );\n  }\n  if (authState.status)\n    return (\n      <div>\n        <Paper className={classes.root}>\n          <UserDetails />\n          <InputLink />\n          <div style={{ height: \"1em\" }}></div>\n          <Transfers />\n        </Paper>\n      </div>\n    );\n  else\n    return (\n      <div>\n        <Paper className={classes.root}>\n          <Typography>\n            <b>Oh hi,</b>\n          </Typography>\n          <Typography>\n            A microservice to quickly create copies of Google Drive files into\n            your account. Inorder to use this service you will have to\n            authenticate your Google account.\n          </Typography>\n          <br />\n          <div className={classes.authButton}>\n            <Button\n              variant=\"outlined\"\n              href={AUTHURL}\n              target=\"_blank\"\n              onClick={handleCallback}\n            >\n              Authorise\n            </Button>\n          </div>\n        </Paper>\n      </div>\n    );\n}\n","import * as React from \"react\";\nimport { render } from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport { store } from \"./store/store\";\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nrender(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  rootElement\n);\n"],"sourceRoot":""}